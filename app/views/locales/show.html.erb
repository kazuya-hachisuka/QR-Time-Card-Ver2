<% if admin_signed_in? || manager_signed_in? %>
<div class="container">
  <div class="row">
    <div class="h2"><%= @locale.locale_name %></div>
  </div>
  <div class="row">
    <%= link_to "Staff追加", new_locale_staff_path(@locale.id), class: "btn btn-outline-info btn-sm mb-3" %>
  </div>
    <%= flash[:work_delete_result] %>
</div>
<div class="container">
  <table class="table table-hover">
    <thead style="background-color:#fff2e5;">
      <tr>
        <th>名前</th>
        <th>出勤</th>
        <th>退勤</th>
        <th>休憩時間</th>
        <th>労働時間</th>
        <th>詳細</th>
      </tr>
    </thead>
    <tbody>
      <% if @staffs.count == 0 %>
        <td>所属スタッフはいません</td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
      <% else %>
        <% @works.each do |work| %>
          <% staff = @staffs.find_by(id: work.staff_id) %>
          <td><%= staff.family_name %><%= staff.given_name %></td>
          <% if work.out != nil %>
            <td><%= l work.in %></td>
            <td><%= l work.out %></td>
            <td><%= totalWorkBreak(work) %></td>
            <% breaks = totalWorkBreak(work) %>
            <td><%= workingHours(work) %></td>
            <td class="text-center"><%= link_to '+', staff_work_path(staff.id,work.id),remote: true %></td>
            <div class="modal fade" id="work-modal" tabindex="-1" role="dialog" aria-labelledby="work-modalLabel" aria-hidden="true"></div>
          <% else %>
            <td><%= work.in %></td>
            <td>-</td>
            <td>-</td>
            <td>-</td>
            <td><%#= link_to '+', staff_work_path(work[:id]) %></td>
          <% end %>
        </tr>
        <% end %>
      <% end %>
    </tbody>
  </table>
</div>
<% elsif signed_in? %>
  <%= render 'punch', locale: @locale %>
<% end %>